<?xml version="1.0" encoding="UTF-8"?>
<Server port="8005"
        shutdown="SHUTDOWN">
	<Listener className="org.apache.catalina.startup.VersionLoggerListener"/>
	<Listener className="org.apache.catalina.core.AprLifecycleListener"
	          SSLEngine="on"/>
	<Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener"/>
	<Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener"/>
	<Listener className="org.apache.catalina.core.ThreadLocalLeakPreventionListener"/>
	<GlobalNamingResources>
		<Resource auth="Container"
		          driverClassName="com.mysql.cj.jdbc.Driver"
		          maxIdle="30"
		          maxTotal="100"
		          maxWaitMillis="10000"
		          name="jdbc/seguridad"
		          password="DauyxaDeGydYVhSyKx9t"
		          type="javax.sql.DataSource"
		          username="tomcat"
		          url="jdbc:mysql://localhost:3306/tomcat?zeroDateTimeBehavior=CONVERT_TO_NULL"/>
	</GlobalNamingResources>
	<Service name="localhost">
		<Connector address="localhost"
		           port="8080"
		           redirectPort="8443"
		           protocol="org.apache.coyote.http11.Http11Nio2Protocol"
		           maxPostSize="-1"
		           disableUploadTimeout="false"
		           connectionTimeout="20000"
		           URIEncoding="UTF-8"/>
		<Connector address="localhost"
		           port="8443"
		           protocol="org.apache.coyote.http11.Http11Nio2Protocol"
		           maxThreads="150"
		           SSLEnabled="true">
			<UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol"/>
			<SSLHostConfig>
				<Certificate certificateKeyFile="conf/ssl/tomcat.key"
				             certificateFile="conf/ssl/tomcat.pem"
				             certificateChainFile="conf/ssl/tomcat.cer"
				             type="RSA"/>
			</SSLHostConfig>
		</Connector>
		<Engine name="localhost"
		        defaultHost="localhost">
			<Realm className="org.apache.catalina.realm.LockOutRealm">
				<Realm className="org.apache.catalina.realm.DataSourceRealm"
				       dataSourceName="jdbc/seguridad"
				       roleNameCol="role_name"
				       userCredCol="user_pass"
				       userNameCol="user_name"
				       userRoleTable="user_roles"
				       userTable="users">
                </Realm>
			</Realm>
			<Host name="localhost"
			      appBase="webapps"
			      unpackWARs="true"
			      autoDeploy="true">
				<Valve className="org.apache.catalina.valves.AccessLogValve"
				       directory="logs"
				       prefix="localhost_access_log"
				       suffix=".txt"
				       pattern="%h %l %u %t &quot;%r&quot; %s %b"/>
			</Host>
		</Engine>
	</Service>
</Server>
